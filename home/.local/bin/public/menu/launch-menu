#!/usr/bin/env bash
set -euo pipefail

: "${LAUNCHER_SCRIPTS_PATH:=$HOME/.local/bin/public/menu}"

source "$LAUNCHER_SCRIPTS_PATH/helpers/fzf-with-options"

SCRIPT_DIR="$LAUNCHER_SCRIPTS_PATH/options"

OPTIONS=(
  "applications:󰣆 Applications"
  "pass: 2FA"
  "ruby-gems: Ruby Gems"
  "kill-process:󰧻 Kill Process"
  "power-management:󰐥 Power Management"
  "clipboard-history: Clipboard"
  "openvpn-connect:󱠾 OpenVPN Connect"
  "browser-history:󰖟 Browser History"
  "wifi-connect:󰤨 Wi-Fi connect"
  "nix-switch: Nix - Switch"
  "nix-search-packages: Nix - Packages"
  "nix-search-options: Nix - Options"
  "nix-search-home-options: Nix - Home Options"
  # "browser-bookmarks:󰖟 Browser Bookmarks"
  # "pass: Passwords"
  #"connect-bluetooth: Connect Bluetooth"
  #"connect-bluetooth:󰖩 Connect Wi-Fi"
  #"search-youtube:󰕧 Search Youtube"
)

choice="$(
  printf '%s\0' "${OPTIONS[@]}" |
    fzf --read0 --delimiter=':' --with-nth=2
)" || exit 0

key="${choice%%:*}"
script="${SCRIPT_DIR}/${key}"

if [[ -x "$script" ]]; then
  exec "$script"
elif [[ -f "$script" ]]; then
  exec bash "$script"
else
  printf "script not found: %s\n" "$script" >&2
  exit 1
fi
