#!/usr/bin/env bash

set -euo pipefail

source "$LAUNCHER_SCRIPTS_PATH/helpers/fzf-with-options"

history_list=$(cliphist list || true)

[ -z "$history_list" ] && exit 0

choice=$(
  printf '%s\n' "$history_list" |
    fzf-with-options \
      --prompt="clipboard> " \
      --no-multi
)

# user cancelled
[ -z "${choice:-}" ] && exit 0

# first field is ID
choice_id=${choice%%$'\t'*}

# copy decoded entry back to clipboard
cliphist decode "$choice_id" | wl-copy

notify-send "Clipboard" "Restored from history"
