#!/usr/bin/env bash

set -euo pipefail

# Build a list of processes and let fzf pick one
choice=$(
  ps -eo pid,user,comm --sort=-pid |
    awk 'NR>1 {printf "%-7s %-12s %s\n", $1, $2, $3}' |
    fzf-with-options \
      --prompt="Kill Â» "
) || exit 0 # ESC in fzf

# First column is PID
pid=$(awk '{print $1}' <<<"$choice")

[ -n "${pid:-}" ] || exit 0

# Kill with sudo
sudo kill "$pid"
